<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Domain Enumeration on</title><link>https://wiki.bufu-sec.com/active_directory/domain_enumeration/</link><description>Recent content in Domain Enumeration on</description><generator>Hugo -- gohugo.io</generator><language>en-US</language><lastBuildDate>Sat, 06 Nov 2021 10:02:54 +0100</lastBuildDate><atom:link href="https://wiki.bufu-sec.com/active_directory/domain_enumeration/index.xml" rel="self" type="application/rss+xml"/><item><title>Domains</title><link>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domains/</link><pubDate>Sun, 07 Nov 2021 17:46:09 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domains/</guid><description>Get current Domain # # AD Module Get-ADDomain # PowerView Get-NetDomain Get Object of another Domain # # AD Module Get-ADDomain -Identity lab.local # PowerView Get-NetDomain -Domain lab.local Get Domain SID for current Domain # # AD Module (Get-ADDomain).DomainSID # PowerView Get-DomainSID Get Domain Policy for current Domain # # PowerView Get-DomainPolicy (Get-DomainPolicy).&amp;#34;System Access&amp;#34; Get Password Policy for another Domain # # PowerView (Get-DomainPolicy -Domain lab.local).&amp;#34;System Access&amp;#34; Get Kerberos Policy for e.</description></item><item><title>Domain Users</title><link>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_users/</link><pubDate>Sun, 07 Nov 2021 17:55:08 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_users/</guid><description>Get List of Users in current Domain # # AD Module Get-ADUser -Filter * -Properties * Get-ADUser -Identity student1 -Properties * Get-ADUser -Filter * -Properties * | Select Name # PowerView Get-NetUser Get-NetUser -Username student1 Get-NetUser | Select cn Get List of all Properties for Users in current Domain # # AD Module Get-ADUser -Filter * -Properties * | Select -First 1 | Get-Member -MemberType *Property | Select Name Get-ADUser -Filter * -Properties * | Select name,@{expression={[datetime]::fromFileTime($_.</description></item><item><title>Domain Computers</title><link>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_computers/</link><pubDate>Sun, 07 Nov 2021 18:02:53 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_computers/</guid><description>Get List of Computers in current Domain # # AD Module Get-ADComputer -Filter * -Properties * Get-ADComputer -Filter * | Select Name # PowerView Get-NetComputer Get-NetComputer -FullData Check for live Hosts (depends on ICMP) # # AD Module Get-ADComputer -Filter * -Properties DNSHostName | %{Test-Connection -Count 1 -ComputerName $_.DNSHostName} # PowerView Get-NetComputer -Ping Information about Operating Systems # # AD Module Get-ADComputer -Filter &amp;#39;OperatingSystem -Like &amp;#34;*Server 2016&amp;#34;&amp;#39; -Properties OperatingSystem | Select Name,OperatingSystem # PowerView Get-NetComputer -OperatingSystem &amp;#34;*Server 2016&amp;#34; Get-NetComputer -FullData | select dnshostname,operatingsystem Get list of sessions on Computer # # PowerView Get-NetSession -ComputerName &amp;#34;dc01.</description></item><item><title>Domain Groups</title><link>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_groups/</link><pubDate>Sun, 07 Nov 2021 17:58:37 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_groups/</guid><description>Get all Groups in current Domain # # AD Module Get-ADGroup -Filter * | Select Name Get-ADGroup -Filter * -Properties * # PowerView Get-NetGroup Get-NetGroup -FullData Get Information about Groups in other Domain # Get-NetGroup -Domain lab.local Get all Groups containing the Word &amp;ldquo;admin&amp;rdquo; in Group Name # # AD Module Get-ADGroup -Filter &amp;#39;Name -Like &amp;#34;*admin*&amp;#34;&amp;#39; | Select Name # PowerView Get-NetGroup &amp;#34;*admin*&amp;#34; Get Information about specific Group # Get-NetGroup -FullData &amp;#34;Domain Admins&amp;#34; Get all Members of Domain Admins Group # # AD Module Get-ADGroupMember -Identity &amp;#34;Domain Admins&amp;#34; -Recursive # PowerView Get-NetGroupMember -GroupName &amp;#34;Domain Admins&amp;#34; -Recurse Get List of Enterprise Admins, only available from Forest Root # Get-NetGroupMember -GroupName &amp;#34;Enterprise Admins&amp;#34; -Domain lab.</description></item><item><title>Domain OUs</title><link>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_ous/</link><pubDate>Sun, 07 Nov 2021 18:09:27 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_ous/</guid><description>Get OUs in a Domain # # AD Module Get-ADOrganizationalUnit -Filter * -Properties * # PowerView Get-NetOU -FullData Get GPO applied on an OU (Read GPOName from gplink attribute from Get-NetOU) # # AD Module Get-GPO -GUID &amp;#34;AB306569-220D-43FF-B03B-83E8F4EF8081&amp;#34; # PowerView Get-NetGPO -GPOname &amp;#34;{AB306569-220D-43FF-B03B-83E8F4EF8081}&amp;#34; Find all Computers in a given OU # Get-DomainComputer -SearchBase &amp;#34;ldap://OU=...&amp;#34; Get the logged on Users for all Machines in any server OU in a particular Domain # Get-DomainOU -Identity *server* -Domain &amp;lt;domain&amp;gt; | %{Get-DomainComputer -SearchBase $_.</description></item><item><title>Domain GPOs</title><link>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_gpos/</link><pubDate>Sun, 07 Nov 2021 18:06:45 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_gpos/</guid><description>General # Security settings Registry-based policy settings GPP like start/shutdown/log-on/logff script settings Software installation Abused for privesc, backdoors, persistence Display RSoP Summary Data # gpresult /R # AD Module Get-GPResultantSetOfPolicy -ReportType Html -Path C:\Users\Administrator\report.html Get List of GPOs in current Domain # # AD Module Get-GPO -All # PowerView Get-NetGPO Get-NetGPO | Select displayname Get-NetGPO -ComputerName ws01.lab.local Get-DomainGPO -ComputerIdentity windows1.testlab.local Get GPO(s) which use Restricted Groups or groups.</description></item><item><title>Domain ACLs</title><link>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_acl/</link><pubDate>Sun, 07 Nov 2021 18:09:32 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_acl/</guid><description>General # Access Control Entries (ACE) correspond to individual permission or audits access Who has permission and what can be done on an object? Two types: DACL -&amp;gt; Defines the permissions trustees (a user or group) have on an object SACL - Logs success and failure audit messages when an object is accessed Enumerate ACLs without resolving GUIDs # # AD Module (Get-ACL &amp;#39;CN=Domain Admins,CN=Users,DC=dc01,DC=dc02,DC=local&amp;#39;).Access Get the ACLs associated with the specified Object # # PowerView Get-ObjectACL -SamAccountName &amp;#34;Users&amp;#34; -ResolveGUIDs Get the ACLs associated with the specified Prefix to be used for Search # # PowerView Get-ObjectACL -ADSPrefix &amp;#39;CN=Administrator,CN=Users&amp;#39; -Verbose Get the ACLs associated with the specified LDAP Path to be used for Search # # PowerView Get-ObjectACL -ADSPath &amp;#34;LDAP://CN=Domain Admins,CN=Users,DC=dc01,DC=dc02,DC=local&amp;#34; -ResolveGUIDs -Verbose Search for interesting ACEs # # PowerView Invoke-ACLScanner -ResolveGUIDs Get the ACLs associated with the specified Path # # PowerView Get-PathACL -Path &amp;#34;\\dc01.</description></item><item><title>Domain Trusts</title><link>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_trusts/</link><pubDate>Sun, 07 Nov 2021 18:09:42 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_trusts/</guid><description>General # Relationship between two domains or forest Trusted Domain Objects (TDOs) represent trust relationship in a domain Types of trusts One-way: users in trusted domain can access resources in the trusting domain Two-way trust: users of both domains can access resources in the other domain Transitive: If A and B trust each other and B and C trust each other, A and C also trust each other (default between domains in same forest) Non-transitive: cannot be extended to other domains in the forest (default between two domains in different forests) Automatic trust: created automatically when creating new subdomain (parent-child, tree-root) Shortcut trusts: used to reduce access time in complex trust scenarios External trusts: between two domains in different forests when forests do not have a turst relationships Forest trusts: between forest root domains Get all Trusts for the current Domain # # AD Module Get-ADTrust Get-ADTrust -Filter * | Select Source,Target,Direction # PowerView Get-NetDomainTrust Get Trusts for specific Domain # # AD Module Get-ADTrust -Identity test.</description></item><item><title>Domain Forest Mappings</title><link>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_forest_mappings/</link><pubDate>Sun, 07 Nov 2021 18:10:03 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/domain_enumeration/domain_forest_mappings/</guid><description>Get Details about the current Forest # # AD Module Get-ADForest Get-ADForest -Identity lab.local # PowerView Get-NetForest Get-NetForest -Forest lab.local Get all Domains in the current Forest # # AD Module (Get-ADForest).Domains # PowerView Get-NetForestDomain Get-NetForestDomain -Forest lab.local Get all Global Catalogs for the current Forest # # AD Module Get-ADForest | Select -ExpandProperty GlobalCatalogs # PowerView Get-NetForestCatalog Get-NetForestCatalog -Forest lab.local Map Trusts of a Forest # # AD Module Get-ADTrust -Filter &amp;#39;msDS-TrustForestTrustInfo -ne &amp;#34;$null&amp;#34;&amp;#39; # PowerView Get-NetForestTrust Get-NetForestTrust -Forest lab.</description></item><item><title>Files and Shares</title><link>https://wiki.bufu-sec.com/active_directory/domain_enumeration/files_and_shares/</link><pubDate>Sun, 07 Nov 2021 18:20:24 +0100</pubDate><guid>https://wiki.bufu-sec.com/active_directory/domain_enumeration/files_and_shares/</guid><description>Find Shares on hosts in current Domain # Invoke-ShareFinder -Verbose Find Shares from other Domain # Invoke-ShareFinder -Domain lab.local Exclude default Shares # Invoke-ShareFinder -ExcludeStandard Show only Shares the current User has Access to # Invoke-ShareFinder -CheckShareAccess Find sensitive Files on Computers # Invoke-FileFinder -Verbose Get all Fileservers # Get-NetFileServer Use alternate Credentials when searching for Files # # Find-InterestingDomainShareFile == old Invoke-FileFinder $Password = &amp;#34;PASSWORD&amp;#34; | ConvertTo-SecureString -AsPlainText -Force $Credential = New-Object System.</description></item></channel></rss>